<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FRC Tuned — Quote & Pricing</title>
  <link rel="stylesheet" href="style.css">
  
  <style>
    /* Define color variables for easy theming */
    :root{
      --accent:#f97316;      /* Primary orange accent */
      --accent-dark:#ea580c; /* Darker accent for hover effects */
      --bg:#0a0a0a;          /* Page background */
      --card:#1a1a1a;        /* Card background */
      --text:#f5f5f5;        /* Default text color */
      --muted:#9ca3af;       /* Muted/secondary text */
    }

    /* Reset default margin and padding */
    *{box-sizing:border-box;margin:0;padding:0}

    /* Body styling */
    body{
      font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background:var(--bg);
      color:var(--text);
      line-height:1.5;
    }

    a{color:inherit;text-decoration:none} /* Links inherit text color */

    /* Header styling */
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:20px 50px;
      background:#181818;
      border-bottom:2px solid var(--accent);
    }
    .logo{
      font-size:1.8rem;
      font-weight:bold;
      color:var(--text);
    }
    .logo span{
      color:var(--accent);
    }
    nav a{
      margin-left:20px;
      padding:5px 10px;
      border-radius:5px;
      transition:color 0.3s, background 0.3s;
    }
    nav a:hover{
      color:var(--accent);
    }
    nav a.active{
      background:var(--accent);
      color:var(--bg);
    }

    /* Main layout for quote page */
    .quote-page{
      display:flex;
      max-width:1200px;
      margin:30px auto;
      gap:30px;
      padding:0 20px;
    }

    .service-list{
      flex:3;
      padding:20px;
      background:var(--card);
      border-radius:10px;
      box-shadow:0 4px 15px rgba(0,0,0,0.2);
    }

    /* Service Categories */
    .service-category{
      margin-bottom:30px;
      border-bottom:1px solid #333;
      padding-bottom:15px;
    }
    .service-category:last-child{
      border-bottom:none;
      margin-bottom:0;
    }
    .service-category h2{
      color:var(--accent);
      margin-bottom:15px;
      border-bottom:2px solid var(--accent);
      display:inline-block;
      padding-bottom:5px;
      font-size:1.8rem;
    }

    /* Individual service item row */
    .item-row{
      display:flex;
      align-items:center;
      padding:10px 0;
      border-top:1px solid #2a2a2a;
    }
    .item-row:first-child{
      border-top:none;
    }

    .item-details{
      flex-grow:1;
      display:flex;
      align-items:center;
    }
    .item-details label{
      cursor:pointer;
      font-size:1.1rem;
      margin-left:10px;
      color:var(--text);
    }
    .item-details small{
      color:var(--muted);
      margin-left:10px;
    }

    .price-display{
      width:100px;
      text-align:right;
      font-weight:bold;
      color:var(--accent);
    }

    .item-quantity{
      width:100px;
      text-align:center;
      display:flex;
      align-items:center;
      justify-content:flex-end;
    }
    .item-quantity label{
      font-size:0.9rem;
      margin-right:10px;
      color:var(--muted);
    }
    .qty{
      width:50px;
      padding:5px;
      border:1px solid #333;
      background:#222;
      color:var(--text);
      border-radius:5px;
      text-align:center;
    }
    .qty:disabled{
      opacity:0.5;
      cursor:not-allowed;
    }

    /* Sidebar/Summary Styling */
    aside{
      flex:1;
      min-width:300px;
      padding:20px;
      background:var(--card);
      border-radius:10px;
      box-shadow:0 4px 15px rgba(0,0,0,0.2);
      position:sticky;
      top:80px; /* Aligns with header height */
      height:fit-content;
    }
    aside h2{
      font-size:1.5rem;
      margin-bottom:20px;
      color:var(--text);
      border-bottom:1px solid #333;
      padding-bottom:10px;
    }

    /* Summary Actions (Total and Buttons) */
    .summary-actions{
      margin-top:20px;
      padding-top:20px;
      border-top:2px solid var(--accent);
      text-align:center;
    }
    #totalLabel{
      font-size:1.2rem;
      font-weight:bold;
      margin-bottom:5px;
      color:var(--text);
    }
    #totalAmt{
      display:block;
      font-size:2.5rem;
      font-weight:bolder;
      color:var(--accent);
      margin-bottom:15px;
    }

    /* Buttons */
    .btn.primary{
      background:var(--accent);
      color:#000;
      font-weight:bold;
      padding:12px 20px;
      border:none;
      border-radius:5px;
      cursor:pointer;
      display:block;
      width:100%;
      margin-top:10px; /* Spacing between buttons */
      transition:background 0.3s;
    }
    .btn.primary:hover{
      background:var(--accent-dark);
    }
    .btn.primary:disabled {
      background: #333;
      cursor: not-allowed;
      color: #999;
    }

    /* Footer styles */
    footer{
      text-align:center;
      padding:20px;
      margin-top:40px;
      border-top:1px solid #222;
      color:var(--muted);
      background:#111;
      width:100%;
    }

    /* Responsive Design */
    @media (max-width: 900px) {
      .quote-page {
        flex-direction: column;
      }
      aside {
        position: static;
        width: 100%;
      }
      header {
        padding: 15px 20px;
      }
      nav a {
        margin-left: 10px;
      }
    }
  </style>

</head>
<body>
  <div id="app-container">
    <header>
      <div class="logo">FRC <span>Tuned</span></div>
      <nav>
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="services.html">Services</a>
        <a href="gallery.html">Gallery</a>
        <a href="contact.html">Contact</a>
        <a href="quote.html" class="active">Quote</a>
      </nav>
    </header>

    <main class="quote-page">
      
      <section class="service-list">
        <h1>Get Your Custom Quote</h1>
        <p>Select the services you are interested in. The total will update automatically, and you can then proceed to payment.</p>

        <form id="quoteForm">
          
          <div class="service-category">
            <h2>ECU & Tuning</h2>
            <div class="item-row">
              <div class="item-details">
                <input type="checkbox" id="ecu_stage1" class="itemChk" data-price="4500">
                <label for="ecu_stage1">Stage 1 ECU Remap</label>
              </div>
              <span class="price-display">R4,500</span>
              <div class="item-quantity">
                <label for="ecu_stage1_qty">Qty:</label>
                <input type="number" id="ecu_stage1_qty" class="qty" value="1" min="1" disabled>
              </div>
            </div>

            <div class="item-row">
              <div class="item-details">
                <input type="checkbox" id="ecu_dyno" class="itemChk" data-price="6500">
                <label for="ecu_dyno">Custom Dyno Tuning</label>
              </div>
              <span class="price-display">R6,500</span>
              <div class="item-quantity">
                <label for="ecu_dyno_qty">Qty:</label>
                <input type="number" id="ecu_dyno_qty" class="qty" value="1" min="1" disabled>
              </div>
            </div>
            
            <div class="item-row">
              <div class="item-details">
                <input type="checkbox" id="tcu_remap" class="itemChk" data-price="3500">
                <label for="tcu_remap">TCU (Transmission) Remap</label>
              </div>
              <span class="price-display">R3,500</span>
              <div class="item-quantity">
                <label for="tcu_remap_qty">Qty:</label>
                <input type="number" id="tcu_remap_qty" class="qty" value="1" min="1" disabled>
              </div>
            </div>
          </div>

          <div class="service-category">
            <h2>Suspension Upgrades</h2>
            <div class="item-row">
              <div class="item-details">
                <input type="checkbox" id="susp_coilovers" class="itemChk" data-price="12000">
                <label for="susp_coilovers">Coilover Installation (Parts not included)</label>
              </div>
              <span class="price-display">R12,000</span>
              <div class="item-quantity">
                <label for="susp_coilovers_qty">Qty:</label>
                <input type="number" id="susp_coilovers_qty" class="qty" value="1" min="1" disabled>
              </div>
            </div>

            <div class="item-row">
              <div class="item-details">
                <input type="checkbox" id="susp_springs" class="itemChk" data-price="5000">
                <label for="susp_springs">Lowering Springs Installation</label>
              </div>
              <span class="price-display">R5,000</span>
              <div class="item-quantity">
                <label for="susp_springs_qty">Qty:</label>
                <input type="number" id="susp_springs_qty" class="qty" value="1" min="1" disabled>
              </div>
            </div>
          </div>

          <div class="service-category">
            <h2>Exhaust & Body</h2>
            <div class="item-row">
              <div class="item-details">
                <input type="checkbox" id="exh_full" class="itemChk" data-price="8000">
                <label for="exh_full">Custom Full Exhaust System</label>
              </div>
              <span class="price-display">R8,000</span>
              <div class="item-quantity">
                <label for="exh_full_qty">Qty:</label>
                <input type="number" id="exh_full_qty" class="qty" value="1" min="1" disabled>
              </div>
            </div>
            
            <div class="item-row">
              <div class="item-details">
                <input type="checkbox" id="body_kit" class="itemChk" data-price="7500">
                <label for="body_kit">Body Kit Installation (Excl. Paint)</label>
              </div>
              <span class="price-display">R7,500</span>
              <div class="item-quantity">
                <label for="body_kit_qty">Qty:</label>
                <input type="number" id="body_kit_qty" class="qty" value="1" min="1" disabled>
              </div>
            </div>
          </div>
        
        </form>
      </section>

      <aside>
        <h2>Quote Summary</h2>
        <form>
          <div class="summary-actions">
            <p id="totalLabel">Calculated Total:</p>
            <span id="totalAmt">R0</span>
            
            <button class="btn primary" type="button" id="proceedToCheckoutBtn" disabled>
                Proceed to Checkout
            </button>
            </div>
        </form>
      </aside>

    </main>

    <footer>© 2025 FRC Tuned — All rights reserved.</footer>
  </div>

  <script>
    const form = document.getElementById('quoteForm');
    // Removed const calcBtn = document.getElementById('calcBtn');
    const totalAmt = document.getElementById('totalAmt');
    const proceedToCheckoutBtn = document.getElementById('proceedToCheckoutBtn');

    // Format number as South African Rand (R)
    function formatZAR(n){
      return 'R' + n.toLocaleString('en-ZA', {minimumFractionDigits:0, maximumFractionDigits:0});
    }

    // Recalculate total and prepare data for checkout
    function recalc(){
      let total = 0;
      const selectedItems = []; // List to store items for checkout

      form.querySelectorAll('.item-row').forEach(row => {
        const chk = row.querySelector('.itemChk');
        const qty = row.querySelector('.qty');
        const titleElement = row.querySelector('label'); 
        
        if(chk.checked){
          const pricePerUnit = Number(chk.dataset.price);
          // Use quantity input value, defaulting to 1 if empty or invalid
          const quantity = Number(qty.value) || 1; 
          const title = titleElement ? titleElement.textContent.trim() : 'Service Item';

          const itemTotalFee = pricePerUnit * quantity;
          total += itemTotalFee;
          
          // Add item to the list for checkout
          selectedItems.push({
            id: chk.id,
            // Include quantity in title for clarity on checkout page
            title: `${title} (x${quantity})`, 
            fee: itemTotalFee, // Send the total fee for this item
            duration: 'Installation', // Placeholder for duration
          });
        }
      });

      totalAmt.textContent = formatZAR(total);

      // Enable/disable the Checkout button and store the data
      if (total > 0) {
        proceedToCheckoutBtn.disabled = false;
        // Store the JSON data on the button for easy access during the click event
        proceedToCheckoutBtn.dataset.items = JSON.stringify(selectedItems);
      } else {
        proceedToCheckoutBtn.disabled = true;
        proceedToCheckoutBtn.removeAttribute('data-items');
      }
    }

    // Event Listener: Handle redirection with selected items data
    proceedToCheckoutBtn.addEventListener('click', () => {
        const selectedItemsJson = proceedToCheckoutBtn.dataset.items;
        
        if (selectedItemsJson) {
            // Encode the JSON string and pass it as a query parameter
            const encodedData = encodeURIComponent(selectedItemsJson);
            window.location.href = `checkout.html?selected=${encodedData}`;
        } else {
            alert("Please select services before proceeding to checkout.");
        }
    });

    // Event listener: Enable quantity input and recalculate when checkbox changes
    form.addEventListener('change', e => {
      if(e.target.classList.contains('itemChk')){
        const qtyInput = e.target.closest('.item-row').querySelector('.qty');
        qtyInput.disabled = !e.target.checked;
        if(e.target.checked) {
            qtyInput.focus();
        }
        recalc(); // Recalculate immediately after checkbox change
      }
    });
    
    // Event listener: Recalculate when quantity changes
    form.addEventListener('input', e => {
        if(e.target.classList.contains('qty')){
            recalc();
        }
    });

    // Run initial calculation when the page loads
    recalc();
  </script>
</body>
</html>